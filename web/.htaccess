<IfModule mod_rewrite.c>
    RewriteEngine On

    # Route 404s to index.php
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_URI} !^/(favicon\.ico|apple-touch-icon.*\.png)$ [NC]
    RewriteRule (.+) index.php [L]
</IfModule>

# Force .mp4 files to download
<FilesMatch "\.mp4$">
    Header set Content-Disposition "attachment"
</FilesMatch>

<IfModule mod_headers.c>
    Header always set X-Content-Type-Options "nosniff"
    Header always set X-Frame-Options "SAMEORIGIN"
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
    Header always set Content-Security-Policy "default-src 'self'; img-src * data:; script-src 'self' 'unsafe-inline' https://*.mailchimp.com https://www.youtube.com https://www.gstatic.com; style-src 'self' 'unsafe-inline' https://*.mailchimp.com; frame-src https://www.youtube.com; connect-src 'self' https://*.mailchimp.com;"
    Header always set Strict-Transport-Security "max-age=63072000; includeSubDomains; preload"
    Header always set Permissions-Policy "geolocation=(), microphone=()"
</IfModule>